<h1>Operation List</h1>
<p>This lists contains all operations in the hospital</p>

<div class="createNewOpSlotSection" ng-hide="globals.currentUser == null || globals.currentUser.role != 'Hospital'">
    <button type="button" class="btn btn-default" aria-label="Left Align" ng-click="showfield=true" ng-hide="showfield">
        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Add new op slot
    </button>



</div>

<br />
<form name="opSlot" ng-controller="OpSlotFormController" class="opSlotForm" >
<table class="table table-striped">
    <tr id="descriptionColumn">


    <!--    <td>
            <div class="btn-group" ng-class="{open: openstartTime}" data-toggle="dropdown" data-datetimepicker-config="{ dropdownSelector: '.my-toggle-select' }">
                <button class="btn">{{selectedstartTime}}<span ng-hide="selectedstartTime != null">StartTime</span></button>
                <button class="btn dropdown-toggle" ng-click="openstartTime=!open"><span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu">
                    <li>
                        <a ng-click="slotStartFilter = null; openstartTime = null; selectedStart = null; getListFromServer();"><span class="glyphicon glyphicon-remove-circle"></span>  Disable Filter </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <div class="dropdown">
                            <a class="dropdown-toggle my-toggle-select" id="startTimeFilter" role="button" data-toggle="dropdown" data-target="#" href="">
                                <div class="input-append"><input type="text" class="input-large" data-ng-model="slotStartFilter"><span class="add-on"><i
                                        class="icon-calendar"></i></span>
                                </div>
                            </a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                <datetimepicker data-ng-model="slotStartFilter"
                                                data-datetimepicker-config="{ dropdownSelector: '.my-toggle-select' }"></datetimepicker>
                            </ul>
                        </div>
                    </li>
                    <li><a ng-click="setSelectedStartDate(slotStartFilter)">Apply Filter</a></li>
                </ul>
            </div>
        </td>
        <td>
            <div class="btn-group" ng-class="{open: openendTime2}" data-toggle="dropdown">
                <button class="btn">{{selectedendTime}}<span ng-hide="selectedendTime != null">EndTime</span></button>
                <button class="btn dropdown-toggle" ng-click="openendTime2=!open"><span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu">
                    <li>
                        <a ng-click="slotEndFilter = null; openendTime2 = null"><span class="glyphicon glyphicon-remove-circle"></span>  Disable Filter </a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <div class="dropdown">
                            <a class="dropdown-toggle my-toggle-select" id="endTimeFilter" role="button" data-toggle="dropdown" data-target="#" href="">
                                <div class="input-append"><input type="text" class="input-large" data-ng-model="slotEndFilter"><span class="add-on"><i
                                        class="icon-calendar"></i></span>
                                </div>
                            </a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                <datetimepicker data-ng-model="slotEndFilter"
                                                data-datetimepicker-config="{ dropdownSelector: '.my-toggle-select' }"></datetimepicker>
                            </ul>
                        </div>
                    </li>
                    <li><a ng-click="setSelectedEndDate(slotEndFilter)">Apply Filter</a></li>
                </ul>
            </div>
        </td>-->

        <td>
            <div ng-controller="DatepickerCtrl">
                   <p class="input-group">
                       <input type="text" class="form-control" datepicker-popup="{{format}}" ng-model="dt" is-open="opened" min-date="'2015-05-01'" max-date="'maxDate'" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" />
                  <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i></button>
                  </span>
                   </p>
            </div>
        </td>
<td>Starttime</td>
        <td>Endtime</td>
        <td>
            <!-- Type Selector button -->
            <div class="btn-group" dropdown is-open="status.isopenType">
                <button type="button" class="btn btn dropdown-toggle" dropdown-toggle ng-disabled="disabled">
                    {{selectedType}}<span ng-hide="selectedType != null">Operation Type </span><span class="caret"></span>
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu">
                    <li>
                        <a ng-click="selectType(null)"><span class="glyphicon glyphicon-remove-circle"></span>  Uncheck All </a>
                    </li>
                    <li class="divider"></li>
                    <li ng-repeat="tmp in oplist | uniq:'type'">
                        <a ng-click="selectType(tmp.type)">{{tmp.type}} &nbsp;<span ng-show="selectedType == tmp.type" class="glyphicon glyphicon-ok"></span></a>
                    </li>
                </ul>
            </div>
        </td>


        <td>
            <!-- Doctor Selector button -->
            <div class="btn-group" dropdown is-open="status.isopenDoctor">
                <button type="button" class="btn btn dropdown-toggle" dropdown-toggle ng-disabled="disabled">
                    {{selectedDoc}}<span ng-hide="selectedDoc != null">Doctor Name</span> <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li>
                        <a ng-click="selectDoc(null)"><span class="glyphicon glyphicon-remove-circle"></span>  Uncheck All </a>
                    </li>
                    <li class="divider"></li>
                    <li ng-repeat="tmp in oplist | uniq:'doctorName'">
                        <a ng-click="selectDoc(tmp.doctorName)">{{tmp.doctorName}} &nbsp;<span ng-show="selectedDoc == tmp.doctorName" class="glyphicon glyphicon-ok"></span></a>
                    </li>
                </ul>
            </div>
        </td>

        <td>
            <!-- Hospital select button button -->
            <div class="btn-group" dropdown is-open="status.isopenHospital">
                <button type="button" class="btn btn dropdown-toggle" dropdown-toggle ng-disabled="disabled">
                    {{selectedKH}}<span ng-hide="selectedKH != null">Hospital Name</span> <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li>
                        <a ng-click="selectKH(null)"><span class="glyphicon glyphicon-remove-circle"></span>  Uncheck All </a>
                    </li>
                    <li class="divider"></li>
                    <li ng-repeat="tmp in oplist | uniq:'hospitalName'">
                        <a ng-click="selectKH(tmp.hospitalName)">{{tmp.hospitalName}} &nbsp;<span ng-show="selectedKH == tmp.hospitalName" class="glyphicon glyphicon-ok"></span></a>
                    </li>
                </ul>
            </div>
        </td>

        <td ng-hide="globals.currentUser == null">
            <!-- Patient select button -->
            <div class="btn-group" dropdown is-open="status.isopenPatient">
                <button type="button" class="btn btn dropdown-toggle" dropdown-toggle ng-disabled="disabled">
                    {{selectedPatient}}<span ng-hide="selectedPatient != null">Patient Name</span> <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                    <li>
                        <a ng-click="selectPatient(null)"><span class="glyphicon glyphicon-remove-circle"></span>  Uncheck All </a>
                    </li>
                    <li class="divider"></li>
                    <li ng-repeat="tmp in oplist | uniq:'patientName'">
                        <a ng-click="selectPatient(tmp.patientName)">{{tmp.patientName}} &nbsp;<span ng-show="selectedPatient == tmp.patientName" class="glyphicon glyphicon-ok"></span></a>
                    </li>
                </ul>
            </div>
        </td>

        <td>&nbsp;</td>
    </tr>

    <!-- Add new OP Slot //-->
      <tr ng-show="showfield">




      <!--      <td>
                &lt;!&ndash; New startTime button &ndash;&gt;
                <div class="btn-group" dropdown is-open="status.isopen">
                    <button type="button" class="btn btn-primary dropdown-toggle" dropdown-toggle ng-disabled="disabled">
                        <a class="dropdown-toggle my-toggle-select" id="startTime" role="button" data-target="#" href="">
                            <div class="input-append"><input type="text" class="input-large" data-ng-model="data.slotStart"><span class="add-on"><i
                                    class="icon-calendar"></i></span>
                            </div>
                        </a>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                        <datetimepicker data-ng-model="data.slotStart"
                                        data-datetimepicker-config="{ dropdownSelector: '.my-toggle-select' }"></datetimepicker>
                    </ul>
                </div>


            </td>-->
     <!--       <td>

                <div class="dropdown">
                    <a class="dropdown-toggle my-toggle-select" id="endTime" role="button" data-toggle="dropdown" data-target="#" href="">
                        <div class="input-append"><input type="text" class="input-large" data-ng-model="data.slotEnd"><span class="add-on"><i
                                class="icon-calendar"></i></span>
                        </div>
                    </a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                        <datetimepicker data-ng-model="data.slotEnd"
                                        data-datetimepicker-config="{ dropdownSelector: '.my-toggle-select' }"></datetimepicker>
                    </ul>
                </div>
            </td>-->
            <td>
                <input name="input" ng-model="data.opType" required><br />
            </td>
            <td>tba</td>
            <td>tba</td>
            <td>tba</td>
            <td>
                <button type="button" class="btn btn-sm" aria-label="Left Align" ng-click="newOpSlot()">
                    <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Add Op Slot
                </button>
            </td>

      </tr>


    <tr ng-repeat="tmp in oplist | filter: selectedKH | filter: selectedType | orderBy:'slotStart':false" ng-class="{true:'success', false:'danger'}[tmp.freeSlot]">


        <td>{{formatDate(tmp.slotStart,"DD.MM.YYYY")}}</td>
        <td>{{formatDate(tmp.slotStart,"HH:MM")}}</td>
        <td>{{formatDate(tmp.slotEnd,"HH:MM")}}</td>
        <td>{{tmp.type}}</td>
        <td>{{tmp.doctorName}} <span ng-hide="globals.currentUser == null">(ID: {{tmp.doctorId}}) </span></td>
        <td>{{tmp.hospitalName}}</td>
        <td ng-hide="globals.currentUser == null">{{tmp.patientName}} (ID: {{tmp.patientId}})</td>
        <td>
                <span ng-show="tmp.freeSlot && globals.currentUser.role[0] == 'Hospital'">
                    <button type="button" class="btn btn-default btn-xs" ng-click="removeOpSlot(tmp.id)">
                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Remove Slot
                    </button>
                </span>
        </td>
    </tr>
</table>
</form>